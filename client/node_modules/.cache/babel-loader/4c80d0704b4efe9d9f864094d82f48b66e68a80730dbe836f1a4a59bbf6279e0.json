{"ast":null,"code":"import*as React from'react';import{request,setAuthHeader}from'../../axios_helper';import WelcomeContent from'../WelcomeContent';import Form from'./Form';import PricesData from'../data/PricesData';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";class LoginForm extends React.Component{constructor(props){super(props);this.onChangeHandler=event=>{let name=event.target.name;let value=event.target.value;this.setState({[name]:value});};this.onSubmitLogin=e=>{e.preventDefault();request(\"POST\",\"/api/v1/auth/login\",{login:this.state.login,password:this.state.password}).then(response=>{localStorage.setItem('token',response.data.token);setAuthHeader(localStorage.getItem('token'));this.props.onLogin();this.setState({success:'Logowanie udane'});this.setState({componentToShow:\"welcome\"});}).catch(error=>{setAuthHeader(null);this.setState({error:'Niepoprawne dane logowania'});});};this.onSubmitRegister=e=>{e.preventDefault();if(this.state.password!==this.state.passwordRep){this.setState({error:'Hasła nie są identyczne'});}else{request(\"POST\",\"/api/v1/auth/register\",{login:this.state.login,password:this.state.password}).then(response=>{localStorage.setItem('token',response.data.token);setAuthHeader(localStorage.getItem('token'));this.setState({success:'Rejestracja udana'});this.setState({componentToShow:\"registered\"});this.setState({error:''});}).catch(error=>{setAuthHeader(null);this.setState({error:'Niepoprawne dane rejestracji'});});}};this.state={componentToShow:\"form\",active:\"login\",login:\"\",password:\"\",passwordRep:\"\",error:\"\",success:\"\"};}render(){const isLoginActive=this.state.active===\"login\";const submitButtonText=isLoginActive?\"Zaloguj się\":\"Zarejestruj się\";return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-4\",children:[this.state.error&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:this.state.error}),this.state.success&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-success\",children:this.state.success})]})}),this.state.componentToShow===\"form\"&&/*#__PURE__*/_jsx(Form,{active:this.state.active,onChange:value=>this.setState({active:value}),onSubmit:this.state.active==='login'?this.onSubmitLogin:this.onSubmitRegister,onChangeHandler:this.onChangeHandler}),this.state.componentToShow===\"welcome\"&&/*#__PURE__*/_jsx(WelcomeContent,{})]});}}export default LoginForm;","map":{"version":3,"names":["React","request","setAuthHeader","WelcomeContent","Form","PricesData","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoginForm","Component","constructor","props","onChangeHandler","event","name","target","value","setState","onSubmitLogin","e","preventDefault","login","state","password","then","response","localStorage","setItem","data","token","getItem","onLogin","success","componentToShow","catch","error","onSubmitRegister","passwordRep","active","render","isLoginActive","submitButtonText","children","className","onChange","onSubmit"],"sources":["/Users/em/Desktop/IS/projekt_koncowy/client/src/components/auth/LoginForm.js"],"sourcesContent":["import * as React from 'react';\nimport { request, setAuthHeader } from '../../axios_helper';\nimport WelcomeContent from '../WelcomeContent';\nimport Form from './Form';\nimport PricesData from '../data/PricesData';\n\nclass LoginForm extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            componentToShow: \"form\",\n            active: \"login\",\n            login: \"\",\n            password: \"\",\n            passwordRep: \"\",\n            error: \"\",\n            success: \"\"\n        };\n    }\n\n\n    onChangeHandler = (event) => {\n        let name = event.target.name;\n        let value = event.target.value;\n        this.setState({ [name]: value });\n    }\n\n    onSubmitLogin = (e) => {\n        e.preventDefault();\n        request(\n            \"POST\",\n            \"/api/v1/auth/login\",\n            {\n                login: this.state.login,\n                password: this.state.password\n            }).then(\n                (response) => {\n                    localStorage.setItem('token', response.data.token);\n                    setAuthHeader(localStorage.getItem('token'));\n                    this.props.onLogin();\n                    this.setState({ success: 'Logowanie udane' });\n                    this.setState({ componentToShow: \"welcome\" });\n                }).catch(\n                    (error) => {\n                        setAuthHeader(null);\n                        this.setState({ error: 'Niepoprawne dane logowania' });\n                    }\n                );\n    }\n\n    onSubmitRegister = (e) => {\n        e.preventDefault();\n        if (this.state.password !== this.state.passwordRep) {\n            this.setState({ error: 'Hasła nie są identyczne' });\n        }\n        else {\n            request(\n                \"POST\",\n                \"/api/v1/auth/register\",\n                {\n                    login: this.state.login,\n                    password: this.state.password\n                }).then(\n                    (response) => {\n                        localStorage.setItem('token', response.data.token);\n                        setAuthHeader(localStorage.getItem('token'));\n                        this.setState({ success: 'Rejestracja udana' });\n                        this.setState({ componentToShow: \"registered\" });\n                        this.setState({ error: '' });\n                    }).catch(\n                        (error) => {\n                            setAuthHeader(null);\n                            this.setState({ error: 'Niepoprawne dane rejestracji' });\n                        }\n                    );\n        }\n\n    }\n\n    render() {\n        const isLoginActive = this.state.active === \"login\";\n        const submitButtonText = isLoginActive ? \"Zaloguj się\" : \"Zarejestruj się\";\n\n        return (\n            <>\n                <div className=\"row justify-content-center\">\n                    <div className=\"col-4\">\n                        {this.state.error && <div className=\"alert alert-danger\">{this.state.error}</div>}\n                        {this.state.success && <div className=\"alert alert-success\">{this.state.success}</div>}\n                    </div >\n                </div >\n                {\n                    this.state.componentToShow === \"form\" &&\n                    <Form\n                        active={this.state.active}\n                        onChange={(value) => this.setState({ active: value })}\n                        onSubmit={this.state.active === 'login' ? this.onSubmitLogin : this.onSubmitRegister}\n                        onChangeHandler={this.onChangeHandler}\n                    />\n                }\n                {this.state.componentToShow === \"welcome\" && <WelcomeContent />}\n            </>\n        );\n    }\n}\nexport default LoginForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}