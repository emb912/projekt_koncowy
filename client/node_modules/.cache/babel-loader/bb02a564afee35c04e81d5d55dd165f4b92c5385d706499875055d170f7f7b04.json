{"ast":null,"code":"import React,{useEffect,useState,forwardRef,useImperativeHandle}from'react';import Chart from'chart.js/auto';import{jsx as _jsx}from\"react/jsx-runtime\";const DataChart=/*#__PURE__*/forwardRef((_ref,ref)=>{let{data,yLabel,downloadFileName}=_ref;const[chartInst,setChartInstance]=useState(null);useImperativeHandle(ref,()=>({downloadChart(){if(chartInst){const link=document.createElement('a');link.href=chartInst.toBase64Image();link.download=\"\".concat(downloadFileName,\".png\");link.click();}}}));useEffect(()=>{if(data.length>0){const chartData={};const keys=[...new Set(data.map(item=>\"\".concat(item.region,\" \").concat(item.type,\" \").concat(item.surface)))];const colors=generateRandomColors(keys.length);data.forEach(item=>{const key=\"\".concat(item.region,\": \").concat(item.type,\", \").concat(item.surface);if(!chartData[key]){chartData[key]=[];}chartData[key].push({x:\"\".concat(item.year,\" Q\").concat(item.quarter),y:item.price||item.amount,surface:item.surface,region:item.region});});const ctx=document.getElementById(downloadFileName).getContext('2d');const existingChart=Chart.getChart(ctx);if(existingChart){existingChart.destroy();}const datasets=Object.keys(chartData).map((key,index)=>{const color=colors[index];return{label:key,data:chartData[key],backgroundColor:color,borderColor:color.replace('0.5','1'),borderWidth:1,pointRadius:5,pointHoverRadius:8,showLine:true};});const chartInst=new Chart(ctx,{type:'line',data:{datasets:datasets},options:{scales:{x:{title:{display:true,text:'Rok i kwartał'}},y:{title:{display:true,text:yLabel}}},plugins:{tooltip:{callbacks:{label:function(context){const dataPoint=context.raw;return\"\".concat(dataPoint.region,\" (powierzchnia: \").concat(dataPoint.surface,\" m\\xB2) - \").concat(dataPoint.y);}}}}}});setChartInstance(chartInst);}},[data]);const generateRandomColors=numColors=>{const colors=[];for(let i=0;i<numColors;i++){const color=\"rgba(\".concat(Math.floor(Math.random()*256),\", \").concat(Math.floor(Math.random()*256),\", \").concat(Math.floor(Math.random()*256),\", 0.5)\");colors.push(color);}return colors;};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"canvas\",{id:downloadFileName,width:\"400\",height:\"260\"})});});export default DataChart;","map":{"version":3,"names":["React","useEffect","useState","forwardRef","useImperativeHandle","Chart","jsx","_jsx","DataChart","_ref","ref","data","yLabel","downloadFileName","chartInst","setChartInstance","downloadChart","link","document","createElement","href","toBase64Image","download","concat","click","length","chartData","keys","Set","map","item","region","type","surface","colors","generateRandomColors","forEach","key","push","x","year","quarter","y","price","amount","ctx","getElementById","getContext","existingChart","getChart","destroy","datasets","Object","index","color","label","backgroundColor","borderColor","replace","borderWidth","pointRadius","pointHoverRadius","showLine","options","scales","title","display","text","plugins","tooltip","callbacks","context","dataPoint","raw","numColors","i","Math","floor","random","children","id","width","height"],"sources":["/Users/em/Desktop/IS/projekt_koncowy/client/src/components/data/DataChart.js"],"sourcesContent":["import React, { useEffect, useState, forwardRef, useImperativeHandle } from 'react';\nimport Chart from 'chart.js/auto';\n\nconst DataChart = forwardRef(({ data, yLabel, downloadFileName }, ref) => {\n    const [chartInst, setChartInstance] = useState(null);\n\n    useImperativeHandle(ref, () => ({\n        downloadChart() {\n            if (chartInst) {\n                const link = document.createElement('a');\n                link.href = chartInst.toBase64Image();\n                link.download = `${downloadFileName}.png`;\n                link.click();\n            }\n        }\n    }));\n\n    useEffect(() => {\n        if (data.length > 0) {\n            const chartData = {};\n            const keys = [...new Set(data.map(item => `${item.region} ${item.type} ${item.surface}`))];\n            const colors = generateRandomColors(keys.length);\n\n            data.forEach(item => {\n                const key = `${item.region}: ${item.type}, ${item.surface}`;\n                if (!chartData[key]) {\n                    chartData[key] = [];\n                }\n                chartData[key].push({ x: `${item.year} Q${item.quarter}`, y: item.price || item.amount, surface: item.surface, region: item.region });\n            });\n\n            const ctx = document.getElementById(downloadFileName).getContext('2d');\n            const existingChart = Chart.getChart(ctx);\n            if (existingChart) {\n                existingChart.destroy();\n            }\n\n            const datasets = Object.keys(chartData).map((key, index) => {\n                const color = colors[index];\n                return {\n                    label: key,\n                    data: chartData[key],\n                    backgroundColor: color,\n                    borderColor: color.replace('0.5', '1'),\n                    borderWidth: 1,\n                    pointRadius: 5,\n                    pointHoverRadius: 8,\n                    showLine: true\n                };\n            });\n\n            const chartInst = new Chart(ctx, {\n                type: 'line',\n                data: {\n                    datasets: datasets\n                },\n                options: {\n                    scales: {\n                        x: {\n                            title: {\n                                display: true,\n                                text: 'Rok i kwartał'\n                            }\n                        },\n                        y: {\n                            title: {\n                                display: true,\n                                text: yLabel\n                            },\n                        }\n                    },\n                    plugins: {\n                        tooltip: {\n                            callbacks: {\n                                label: function (context) {\n                                    const dataPoint = context.raw;\n                                    return `${dataPoint.region} (powierzchnia: ${dataPoint.surface} m²) - ${dataPoint.y}`;\n                                }\n                            }\n                        }\n                    }\n\n                }\n            });\n            setChartInstance(chartInst);\n        }\n    }, [data]);\n\n    const generateRandomColors = (numColors) => {\n        const colors = [];\n        for (let i = 0; i < numColors; i++) {\n            const color = `rgba(${Math.floor(Math.random() * 256)}, ${Math.floor(Math.random() * 256)}, ${Math.floor(Math.random() * 256)}, 0.5)`;\n            colors.push(color);\n        }\n        return colors;\n    };\n\n    return (\n        <div>\n            <canvas id={downloadFileName} width=\"400\" height=\"260\"></canvas>\n        </div>\n    );\n});\n\nexport default DataChart;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}